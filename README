Premier Widget


Url du fichier des applications :

http://192.168.1.81/applications_sample.xml


 ////////////////////////////////////////////////////////////////////////////////
 //
 // MAGIC FUNCTIONS
 //
 ////////////////////////////////////////////////////////////////////////////////

 function getRSS(url) {
     loading.innerText = "Connecting...";
     rssObj = new ActiveXObject("Msxml2.XMLHTTP");
     rssObj.open("GET",
                 url,
                 true);
     rssObj.onreadystatechange = function() {
         if (rssObj.readyState === 4) {
             if (rssObj.status === 200) {
                 loading.innerText = "";
                 rssXML = rssObj.responseXML;
                 page = 0;
                 parseRSS();
                 if (chkConn) {
                     clearInterval(chkConn);
                 }
             }
             else {
                 var chkConn;
                 loading.innerText = "Unable to connect...";
                 chkConn = setInterval(getRSS, 30 * 60000);
             }
         }
         else {
             loading.innerText = "Connecting...";
         }
     }
     rssObj.send(null);
 }

 function parseRSS(page) {
     if (!page) {
         page = 0;
     }
     start = page * 5;
     end = (page * 5) + 5;
     rssItems = rssXML.getElementsByTagName("applications");
     rssTitle = null;
     rssAuthors = null;
     rssSummary = null;
     rssLink = null;

     if (end > rssItems.length) {
         end = rssItems.length
     }
     for (i = start; i <  rssItems.length; i++) {
         rssTitle = rssItems[i].firstChild.text;
         rssDisplayName = rssItems[i].getElementsByTagName("displayName");
         tmpApplication.DisplayName = rssDisplayName[0].text;

         leaderName = rssItems[i].getElementsByTagName("leaderName");
         tmpApplication.leaderName = leaderName[0].text;

         rssSummary = rssItems[i].getElementsByTagName("description");
         tmpApplication.rssSummary = rssSummary[0].text;

         g_applicationList[i]=tmpApplication;
     }
 }

